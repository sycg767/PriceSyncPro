# 🌐 PriceSyncPro Web 版本

**New API 智能价格同步工具 - Web 版本**

---

## 📝 说明

这是 PriceSyncPro 的 Web 版本，适合有数据库访问权限的用户使用。

**如果你只有 New API 后台登录权限，推荐使用浏览器插件版本！**  
👉 [返回主页查看插件版本](../README.md)

---

## 🚀 快速开始

### 第一步：启动本地服务器

**为什么需要本地服务器？**  
因为浏览器的 CORS 安全策略限制，直接打开 HTML 文件无法访问上游 API。

**启动方式：**
```bash
# 方法1：双击运行（推荐）
双击 start_server.bat 文件

# 方法2：命令行（如果批处理失败）
python -m http.server 8000
# 或者
python3 -m http.server 8000
```

启动成功后，会显示：
```
服务器已启动: http://localhost:8000
请在浏览器中打开 http://localhost:8000/index.html
```

### 第二步：打开工具页面

在浏览器中访问：`http://localhost:8000/index.html`

### 第三步：分析上游价格

1. **切换到"📊 价格分析"标签页**
2. **输入上游定价 URL**
   ```
   示例：https://api.example.com/api/pricing
   ```
3. **点击"🔍 开始智能分析"**
4. **查看分析结果**
   - 推断基础价格（如 $2.00）
   - 推断置信度（如 95%）
   - 匹配模型数量
   - 详细价格表格

### 第四步：生成 SQL

1. **切换到"🗄️ SQL 生成器"标签页**
2. **输入模型前缀**（可选）
   ```
   示例：KYX/
   ```
3. **选择 SQL 模式**
   - **合并模式**（推荐）：智能合并，保留其他渠道配置
   - **备份模式**：先备份再合并
4. **点击"🔧 生成 SQL"**
5. **点击"📋 复制 SQL"**

### 第五步：执行 SQL

1. 打开你的数据库管理工具（如 phpMyAdmin、Navicat）
2. 粘贴并执行复制的 SQL
3. 确认更新成功

### 第六步：验证结果

在 New API 后台查看：
```
设置 → 运营设置 → 模型倍率设置
```

---

## 📖 使用指南

Web 版本包含两个标签页：

### 📊 价格分析
- 输入上游定价 URL
- 智能推断基础价格
- 查看详细价格表格
- 导出 CSV 数据

### 🗄️ SQL 生成器
- 输入模型前缀（可选）
- 选择 SQL 模式
- 生成智能合并 SQL
- 一键复制到剪贴板

### 📖 使用指南（新增）
- 快速开始教程
- 核心功能说明
- SQL 模式说明
- 注意事项

### ℹ️ 关于（新增）
- 项目简介
- 核心特性
- GitHub 链接
- 作者信息

---

## ⚙️ SQL 模式说明

### 合并模式（推荐）
- 智能合并配置
- 只更新当前前缀的模型
- 保留其他渠道配置
- 适合日常使用

### 带备份模式
- 在合并前先创建备份表
- 适合重要更新或首次使用
- 可以回滚到备份状态

---

## ⚠️ 注意事项

- 执行 SQL 前请确保已备份数据库
- 建议先在测试环境验证 SQL 的正确性
- 置信度低于 80% 时，建议手动检查基础价是否正确
- 如遇到问题，请查看浏览器控制台的详细日志

---

## ❓ 常见问题

### Q1: Python 命令不存在怎么办？

**答**：`start_server.bat` 会自动检测 Python、Node.js 或 PHP。如果都没有，请安装 Python：
```
https://www.python.org/downloads/
安装时勾选 "Add Python to PATH"
```

### Q2: 为什么需要本地服务器？

**答**：浏览器的 CORS 安全策略禁止 `file://` 协议的页面访问远程 API。使用本地服务器（`http://localhost`）可以绕过这个限制。

### Q3: 如何验证价格是否正确？

**答**：
1. 查看工具显示的"置信度"（90%+ 说明准确）
2. 在后台"模型倍率设置"中对比几个常用模型
3. 手动计算：`官方价格 / model_ratio = 基础价`

### Q4: 会覆盖其他渠道的配置吗？

**答**：不会。工具使用智能合并策略，只更新当前前缀的模型，完全保留其他渠道配置。

---

## 🔌 推荐使用插件版本

如果你只有 New API 后台登录权限（无数据库访问权限），强烈推荐使用浏览器插件版本：

### 插件版本的优势
- ✨ **一键自动同步**：无需手动执行 SQL
- 🔒 **更安全**：使用浏览器 Cookie 认证
- 💾 **配置预设**：保存常用配置
- 📊 **实时反馈**：5 阶段进度条

👉 [查看插件版本安装教程](../README.md)

---

## 📁 文件说明

```
PriceSyncPro-WebVersion/
├── index.html              # Web 界面
├── pricing-engine.js       # 定价引擎
├── official_prices.json    # 官方价格数据库（120+ 模型）
├── start_server.bat        # 本地服务器启动脚本
└── README.md              # 本文档
```

---

## 📄 开源协议

MIT License - 可自由使用、修改、分发

---

**PriceSyncPro Web 版本 | 智能价格同步工具** 🌐
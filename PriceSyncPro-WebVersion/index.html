
<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PriceSyncPro - New API å®šä»·åŒæ­¥å·¥å…·</title>
  <style>
    /* ========================================
       iOS-Style Variables & Reset
       ======================================== */
    :root {
      --color-primary: #007AFF;
      --color-secondary: #5856D6;
      --color-success: #34C759;
      --color-warning: #FF9500;
      --color-danger: #FF3B30;
      --color-bg: #F2F2F7;
      --color-card: #FFFFFF;
      --color-text-primary: #000000;
      --color-text-secondary: #8E8E93;
      --color-separator: rgba(60, 60, 67, 0.12);
      --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.08);
      --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.1);
      --radius-sm: 10px;
      --radius-md: 14px;
      --radius-lg: 20px;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", "SF Pro Text", "Helvetica Neue", Arial, sans-serif;
      background: var(--color-bg);
      color: var(--color-text-primary);
      font-size: 15px;
      line-height: 1.5;
      padding: 20px;
      min-height: 100vh;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
    }

    /* ========================================
       Header
       ======================================== */
    .header-card {
      background: var(--color-card);
      border-radius: var(--radius-lg);
      padding: 32px;
      margin-bottom: 16px;
      box-shadow: var(--shadow-sm);
    }

    .header-content {
      display: flex;
      align-items: center;
      gap: 20px;
    }

    .app-icon {
      width: 64px;
      height: 64px;
      background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-secondary) 100%);
      border-radius: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 32px;
      box-shadow: 0 4px 12px rgba(0, 122, 255, 0.3);
      flex-shrink: 0;
    }

    .header-text h1 {
      font-size: 28px;
      font-weight: 600;
      letter-spacing: -0.5px;
      margin-bottom: 6px;
    }

    .header-text p {
      font-size: 16px;
      color: var(--color-text-secondary);
      font-weight: 400;
    }

    /* ========================================
       Tabs
       ======================================== */
    .tabs-card {
      background: var(--color-card);
      border-radius: var(--radius-lg);
      padding: 8px;
      margin-bottom: 16px;
      box-shadow: var(--shadow-sm);
      display: flex;
      gap: 8px;
    }

    .tab {
      flex: 1;
      padding: 12px 20px;
      background: transparent;
      border: none;
      border-radius: var(--radius-md);
      font-size: 15px;
      font-weight: 500;
      color: var(--color-text-secondary);
      cursor: pointer;
      transition: all 0.2s ease;
      font-family: inherit;
    }

    .tab.active {
      background: var(--color-primary);
      color: white;
    }

    .tab:not(.active):active {
      background: var(--color-bg);
    }

    /* ========================================
       Tab Content
       ======================================== */
    .tab-content {
      display: none;
    }

    .tab-content.active {
      display: block;
      animation: fadeIn 0.3s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-8px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* ========================================
       Info Banner
       ======================================== */
    .info-banner {
      background: var(--color-card);
      border-radius: var(--radius-lg);
      padding: 16px 20px;
      margin-bottom: 16px;
      display: flex;
      align-items: center;
      gap: 12px;
      box-shadow: var(--shadow-sm);
    }

    .info-banner-icon {
      font-size: 20px;
      flex-shrink: 0;
    }

    .info-banner-text {
      font-size: 14px;
      color: var(--color-text-secondary);
      line-height: 1.5;
    }

    /* ========================================
       Input Card
       ======================================== */
    .input-card {
      background: var(--color-card);
      border-radius: var(--radius-lg);
      padding: 24px;
      margin-bottom: 16px;
      box-shadow: var(--shadow-sm);
    }

    .input-group {
      margin-bottom: 20px;
    }

    .input-group:last-child {
      margin-bottom: 0;
    }

    .input-label {
      font-size: 13px;
      font-weight: 600;
      color: var(--color-text-secondary);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 8px;
      display: block;
    }

    .input-field {
      width: 100%;
      padding: 14px 16px;
      border: 1px solid var(--color-separator);
      border-radius: var(--radius-md);
      font-size: 16px;
      background: var(--color-card);
      color: var(--color-text-primary);
      transition: all 0.2s ease;
      font-family: inherit;
    }

    .input-field:focus {
      outline: none;
      border-color: var(--color-primary);
      box-shadow: 0 0 0 3px rgba(0, 122, 255, 0.1);
    }

    .input-field::placeholder {
      color: var(--color-text-secondary);
      opacity: 0.6;
    }

    select.input-field {
      cursor: pointer;
      appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg width='12' height='7' viewBox='0 0 12 7' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M1 1L6 6L11 1' stroke='%238E8E93' stroke-width='2' stroke-linecap='round'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 16px center;
      padding-right: 40px;
    }

    .input-hint {
      margin-top: 8px;
      font-size: 13px;
      color: var(--color-text-secondary);
      line-height: 1.4;
    }

    /* ========================================
       Buttons
       ======================================== */
    .btn-group {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 12px;
    }

    .btn {
      height: 50px;
      border: none;
      border-radius: var(--radius-md);
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      font-family: inherit;
      letter-spacing: -0.2px;
      box-shadow: var(--shadow-sm);
    }

    .btn:active:not(:disabled) {
      transform: scale(0.98);
    }

    .btn-primary {
      background: var(--color-primary);
      color: white;
    }

    .btn-primary:active:not(:disabled) {
      background: #0051D5;
    }

    .btn-secondary {
      background: var(--color-card);
      color: var(--color-primary);
      border: 1px solid var(--color-separator);
    }

    .btn-secondary:active:not(:disabled) {
      background: var(--color-bg);
    }

    .btn:disabled {
      opacity: 0.4;
      cursor: not-allowed;
    }

    /* ========================================
       Loading Spinner
       ======================================== */
    .spinner {
      display: inline-block;
      width: 18px;
      height: 18px;
      border: 2px solid rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      border-top-color: white;
      animation: spin 0.6s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* ========================================
       Message Card
       ======================================== */
    .message-card {
      background: var(--color-card);
      border-radius: var(--radius-lg);
      padding: 16px 20px;
      margin-bottom: 16px;
      box-shadow: var(--shadow-sm);
      font-size: 14px;
      line-height: 1.6;
      display: none;
      animation: slideIn 0.3s ease;
    }

    .message-card.show {
      display: flex;
      align-items: flex-start;
      gap: 12px;
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(-8px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .message-info {
      background: rgba(0, 122, 255, 0.08);
      color: var(--color-primary);
    }

    .message-success {
      background: rgba(52, 199, 89, 0.08);
      color: var(--color-success);
    }

    .message-error {
      background: rgba(255, 59, 48, 0.08);
      color: var(--color-danger);
    }

    .message-icon {
      font-size: 18px;
      flex-shrink: 0;
      line-height: 1;
      display: flex;
      align-items: center;
    }

    /* ========================================
       Stats Grid
       ======================================== */
    .stats-card {
      background: var(--color-card);
      border-radius: var(--radius-lg);
      padding: 24px;
      margin-bottom: 16px;
      box-shadow: var(--shadow-sm);
      display: none;
    }

    .stats-card.show {
      display: block;
      animation: slideIn 0.3s ease;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 16px;
    }

    .stat-item {
      background: var(--color-bg);
      border-radius: var(--radius-md);
      padding: 20px;
      text-align: center;
    }

    .stat-label {
      font-size: 13px;
      color: var(--color-text-secondary);
      font-weight: 500;
      margin-bottom: 8px;
      text-transform: uppercase;
      letter-spacing: 0.3px;
    }

    .stat-value {
      font-size: 28px;
      font-weight: 600;
      color: var(--color-text-primary);
      letter-spacing: -0.5px;
    }

    /* ========================================
       Results Table
       ======================================== */
    .results-card {
      background: var(--color-card);
      border-radius: var(--radius-lg);
      padding: 24px;
      margin-bottom: 16px;
      box-shadow: var(--shadow-sm);
      display: none;
    }

    .results-card.show {
      display: block;
      animation: slideIn 0.3s ease;
    }

    .results-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 16px;
    }

    .results-title {
      font-size: 20px;
      font-weight: 600;
      letter-spacing: -0.3px;
    }

    .table-wrapper {
      border-radius: var(--radius-md);
      overflow: hidden;
      border: 1px solid var(--color-separator);
      max-height: 600px;
      overflow-y: auto;
    }

    .table-wrapper::-webkit-scrollbar {
      width: 8px;
    }

    .table-wrapper::-webkit-scrollbar-track {
      background: transparent;
    }

    .table-wrapper::-webkit-scrollbar-thumb {
      background: rgba(0, 0, 0, 0.15);
      border-radius: 4px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 14px;
    }

    thead {
      position: sticky;
      top: 0;
      background: var(--color-bg);
      z-index: 10;
    }

    th {
      padding: 12px 16px;
      text-align: left;
      font-weight: 600;
      font-size: 12px;
      color: var(--color-text-secondary);
      text-transform: uppercase;
      letter-spacing: 0.3px;
    }

    td {
      padding: 12px 16px;
      border-bottom: 1px solid var(--color-separator);
      background: white;
    }

    tbody tr:last-child td {
      border-bottom: none;
    }

    .model-name {
      font-weight: 500;
      color: var(--color-text-primary);
    }

    .price-cell {
      font-family: 'SF Mono', 'Monaco', monospace;
      font-weight: 600;
      color: var(--color-success);
    }

    .mode-badge {
      display: inline-block;
      padding: 4px 10px;
      border-radius: 8px;
      font-size: 12px;
      font-weight: 600;
      letter-spacing: 0.2px;
    }

    .mode-peruse {
      background: rgba(255, 149, 0, 0.12);
      color: var(--color-warning);
    }

    .mode-usage {
      background: rgba(0, 122, 255, 0.12);
      color: var(--color-primary);
    }

    /* ========================================
       SQL Output
       ======================================== */
    .sql-output {
      background: #1e1e1e;
      color: #d4d4d4;
      padding: 20px;
      border-radius: var(--radius-md);
      font-family: 'SF Mono', 'Monaco', 'Courier New', monospace;
      font-size: 13px;
      max-height: 500px;
      overflow: auto;
      margin: 16px 0;
      white-space: pre-wrap;
      word-break: break-all;
      display: none;
    }

    .sql-output.show {
      display: block;
    }

    /* ========================================
       Footer
       ======================================== */
    .footer {
      text-align: center;
      font-size: 13px;
      color: var(--color-text-secondary);
      padding: 32px 0;
    }

    .footer-badge {
      color: var(--color-primary);
      font-weight: 600;
    }

    /* ========================================
       Utility Classes
       ======================================== */
    .hidden {
      display: none !important;
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Header -->
    <div class="header-card">
      <div class="header-content">
        <div class="app-icon">ğŸš€</div>
        <div class="header-text">
          <h1>PriceSyncPro</h1>
          <p>æ™ºèƒ½åˆ†æä¸Šæ¸¸ä»·æ ¼ + è‡ªåŠ¨ç”Ÿæˆæ•°æ®åº“æ›´æ–° SQL</p>
        </div>
      </div>
    </div>

    <!-- Tabs -->
    <div class="tabs-card">
      <button class="tab active" onclick="switchTab('analyze')">ğŸ“Š ä»·æ ¼åˆ†æ</button>
      <button class="tab" onclick="switchTab('sql')">ğŸ—„ï¸ SQL ç”Ÿæˆå™¨</button>
      <button class="tab" onclick="switchTab('guide')">ğŸ“– ä½¿ç”¨æŒ‡å—</button>
      <button class="tab" onclick="switchTab('about')">â„¹ï¸ å…³äº</button>
    </div>

    <!-- Price Analysis Tab -->
    <div class="tab-content active" id="analyze-tab">
      <div class="info-banner">
        <span class="info-banner-icon">ğŸ’¡</span>
        <span class="info-banner-text">æ­¤å·¥å…·é€šè¿‡"ä¼—æ•°æŠ•ç¥¨"ç®—æ³•æ™ºèƒ½æ¨æ–­ä¸Šæ¸¸ç³»ç»Ÿçš„éšè—åŸºç¡€ä»·ï¼Œç„¶åç²¾ç¡®è®¡ç®—æ¯ä¸ªæ¨¡å‹çš„çœŸå®ä»·æ ¼</span>
      </div>

      <div class="input-card">
        <div class="input-group">
          <label class="input-label">ä¸Šæ¸¸å®šä»· URL</label>
          <input
            type="text"
            id="upstreamUrl"
            class="input-field"
            placeholder="https://api.example.com/api/pricing"
          >
          <div class="input-hint">é¡µé¢ URL æˆ–ç›´æ¥ API ç«¯ç‚¹</div>
        </div>
      </div>

      <div class="input-card">
        <div class="btn-group">
          <button class="btn btn-primary" id="analyzeBtn">
            <span>ğŸ”</span>
            <span>å¼€å§‹æ™ºèƒ½åˆ†æ</span>
          </button>
          <button class="btn btn-secondary" id="sampleBtn">
            <span>ğŸ§ª</span>
            <span>åŠ è½½ç¤ºä¾‹æ•°æ®</span>
          </button>
          <button class="btn btn-secondary" id="exportBtn" disabled>
            <span>ğŸ“Š</span>
            <span>å¯¼å‡º CSV</span>
          </button>
          <button class="btn btn-secondary" id="copyBtn" disabled>
            <span>ğŸ“‹</span>
            <span>å¤åˆ¶æ•°æ®</span>
          </button>
        </div>
      </div>

      <div id="messageArea"></div>

      <div id="statsCard" class="stats-card">
        <div class="stats-grid">
          <div class="stat-item">
            <div class="stat-label">ğŸ¯ æ¨æ–­åŸºç¡€ä»·</div>
            <div class="stat-value" id="basePriceStat">-</div>
          </div>
          <div class="stat-item">
            <div class="stat-label">ğŸ² æ¨æ–­ç½®ä¿¡åº¦</div>
            <div class="stat-value" id="confidenceStat">-</div>
          </div>
          <div class="stat-item">
            <div class="stat-label">ğŸ“¦ åŒ¹é…æ¨¡å‹æ•°</div>
            <div class="stat-value" id="matchedStat">-</div>
          </div>
          <div class="stat-item">
            <div class="stat-label">ğŸ“š æ€»æ¨¡å‹æ•°</div>
            <div class="stat-value" id="totalStat">-</div>
          </div>
        </div>
      </div>

      <div id="resultsCard" class="results-card">
        <div class="results-header">
          <h3 class="results-title">è®¡ç®—ç»“æœ</h3>
        </div>
        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>æ¨¡å‹åç§°</th>
                <th>åŸå§‹åç§°</th>
                <th>è®¡è´¹æ¨¡å¼</th>
                <th>è¾“å…¥ä»·æ ¼ ($/1M)</th>
                <th>è¾“å‡ºä»·æ ¼ ($/1M)</th>
                <th>Model Ratio</th>
                <th>Completion Ratio</th>
              </tr>
            </thead>
            <tbody id="resultsBody"></tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- SQL Generator Tab -->
    <div class="tab-content" id="sql-tab">
      <div class="info-banner">
        <span class="info-banner-icon">â„¹ï¸</span>
        <span class="info-banner-text">è¯·å…ˆåœ¨"ä»·æ ¼åˆ†æ"æ ‡ç­¾å®Œæˆåˆ†æï¼Œç„¶åé€‰æ‹© SQL æ¨¡å¼ç”Ÿæˆæ›´æ–°è„šæœ¬</span>
      </div>

      <div class="input-card">
        <div class="input-group">
          <label class="input-label">æ¨¡å‹åç§°å‰ç¼€ï¼ˆå¯é€‰ï¼‰</label>
          <input
            type="text"
            id="modelPrefix"
            class="input-field"
            placeholder="ä¾‹å¦‚ï¼šKYX/"
          >
          <div class="input-hint">ä¸ºä¸Šæ¸¸æ¨¡å‹æ·»åŠ è‡ªå®šä¹‰å‰ç¼€ï¼Œç•™ç©ºåˆ™ä¸æ·»åŠ å‰ç¼€</div>
        </div>

        <div class="input-group">
          <label class="input-label">SQL æ¨¡å¼</label>
          <select id="sqlMode" class="input-field">
            <option value="merge">åˆå¹¶æ¨¡å¼ï¼ˆæ™ºèƒ½åˆå¹¶ï¼Œä¿ç•™å…¶ä»–é…ç½®ï¼‰</option>
            <option value="backup">å¸¦å¤‡ä»½æ¨¡å¼ï¼ˆå…ˆå¤‡ä»½å†åˆå¹¶ï¼‰</option>
          </select>
        </div>
      </div>

      <div class="input-card">
        <div class="btn-group">
          <button class="btn btn-primary" id="generateSqlBtn" disabled>
            <span>ğŸ”§</span>
            <span>ç”Ÿæˆ SQL</span>
          </button>
          <button class="btn btn-secondary" id="copySqlBtn" disabled>
            <span>ğŸ“‹</span>
            <span>å¤åˆ¶ SQL</span>
          </button>
        </div>
      </div>

      <div id="sqlMessageArea"></div>

      <div id="sqlOutput" class="sql-output"></div>
    </div>

    <!-- Guide Tab -->
    <div class="tab-content" id="guide-tab">
      <div class="input-card">
        <h2 style="font-size: 24px; font-weight: 600; margin-bottom: 20px; color: var(--color-text-primary);">ğŸ“– ä½¿ç”¨æŒ‡å—</h2>
        
        <div style="margin-bottom: 24px;">
          <h3 style="font-size: 18px; font-weight: 600; margin-bottom: 12px; color: var(--color-primary);">ğŸš€ å¿«é€Ÿå¼€å§‹</h3>
          <div style="background: var(--color-bg); padding: 16px; border-radius: var(--radius-md); line-height: 1.8;">
            <p style="margin-bottom: 12px;"><strong>ç¬¬ä¸€æ­¥ï¼š</strong>åœ¨"ğŸ“Š ä»·æ ¼åˆ†æ"æ ‡ç­¾é¡µè¾“å…¥ä¸Šæ¸¸å®šä»· URL</p>
            <p style="margin-bottom: 12px;"><strong>ç¬¬äºŒæ­¥ï¼š</strong>ç‚¹å‡»"ğŸ” å¼€å§‹æ™ºèƒ½åˆ†æ"ï¼Œç­‰å¾…åˆ†æå®Œæˆ</p>
            <p style="margin-bottom: 12px;"><strong>ç¬¬ä¸‰æ­¥ï¼š</strong>åˆ‡æ¢åˆ°"ğŸ—„ï¸ SQL ç”Ÿæˆå™¨"æ ‡ç­¾é¡µ</p>
            <p style="margin-bottom: 12px;"><strong>ç¬¬å››æ­¥ï¼š</strong>è¾“å…¥æ¨¡å‹å‰ç¼€ï¼ˆå¯é€‰ï¼‰ï¼Œé€‰æ‹© SQL æ¨¡å¼</p>
            <p style="margin-bottom: 0;"><strong>ç¬¬äº”æ­¥ï¼š</strong>ç”Ÿæˆ SQL å¹¶å¤åˆ¶åˆ°æ•°æ®åº“æ‰§è¡Œ</p>
          </div>
        </div>

        <div style="margin-bottom: 24px;">
          <h3 style="font-size: 18px; font-weight: 600; margin-bottom: 12px; color: var(--color-primary);">ğŸ’¡ æ ¸å¿ƒåŠŸèƒ½</h3>
          <div style="background: var(--color-bg); padding: 16px; border-radius: var(--radius-md); line-height: 1.8;">
            <p style="margin-bottom: 12px;"><strong>ğŸ§  æ™ºèƒ½ä»·æ ¼æ¨æ–­ï¼š</strong>ä½¿ç”¨"ä¼—æ•°æŠ•ç¥¨"ç®—æ³•è‡ªåŠ¨æ¨æ–­ä¸Šæ¸¸ç³»ç»Ÿçš„éšè—åŸºç¡€ä»·</p>
            <p style="margin-bottom: 12px;"><strong>ğŸ¯ ç²¾ç¡®è®¡ç®—ï¼š</strong>æ”¯æŒæŒ‰æ¬¡è®¡è´¹å’ŒæŒ‰é‡è®¡è´¹ä¸¤ç§æ¨¡å¼ï¼Œç²¾ç¡®è®¡ç®—æ¯ä¸ªæ¨¡å‹ä»·æ ¼</p>
            <p style="margin-bottom: 12px;"><strong>ğŸ”§ æ™ºèƒ½åˆå¹¶ï¼š</strong>åªæ›´æ–°å½“å‰å‰ç¼€çš„æ¨¡å‹ï¼Œå®Œå…¨ä¿ç•™å…¶ä»–æ¸ é“é…ç½®</p>
            <p style="margin-bottom: 0;"><strong>ğŸ“Š æ•°æ®å¯¼å‡ºï¼š</strong>æ”¯æŒå¯¼å‡º CSV æ ¼å¼ï¼Œæ–¹ä¾¿æ•°æ®åˆ†æå’Œå¤‡ä»½</p>
          </div>
        </div>

        <div style="margin-bottom: 24px;">
          <h3 style="font-size: 18px; font-weight: 600; margin-bottom: 12px; color: var(--color-primary);">âš™ï¸ SQL æ¨¡å¼è¯´æ˜</h3>
          <div style="background: var(--color-bg); padding: 16px; border-radius: var(--radius-md); line-height: 1.8;">
            <p style="margin-bottom: 12px;"><strong>åˆå¹¶æ¨¡å¼ï¼ˆæ¨èï¼‰ï¼š</strong>æ™ºèƒ½åˆå¹¶é…ç½®ï¼Œåªæ›´æ–°å½“å‰å‰ç¼€çš„æ¨¡å‹ï¼Œä¿ç•™å…¶ä»–æ¸ é“é…ç½®</p>
            <p style="margin-bottom: 0;"><strong>å¸¦å¤‡ä»½æ¨¡å¼ï¼š</strong>åœ¨åˆå¹¶å‰å…ˆåˆ›å»ºå¤‡ä»½è¡¨ï¼Œé€‚åˆé‡è¦æ›´æ–°æˆ–é¦–æ¬¡ä½¿ç”¨</p>
          </div>
        </div>

        <div style="margin-bottom: 24px;">
          <h3 style="font-size: 18px; font-weight: 600; margin-bottom: 12px; color: var(--color-warning);">âš ï¸ æ³¨æ„äº‹é¡¹</h3>
          <div style="background: rgba(255, 149, 0, 0.08); padding: 16px; border-radius: var(--radius-md); line-height: 1.8; color: var(--color-warning);">
            <p style="margin-bottom: 12px;">â€¢ æ‰§è¡Œ SQL å‰è¯·ç¡®ä¿å·²å¤‡ä»½æ•°æ®åº“</p>
            <p style="margin-bottom: 12px;">â€¢ å»ºè®®å…ˆåœ¨æµ‹è¯•ç¯å¢ƒéªŒè¯ SQL çš„æ­£ç¡®æ€§</p>
            <p style="margin-bottom: 12px;">â€¢ ç½®ä¿¡åº¦ä½äº 80% æ—¶ï¼Œå»ºè®®æ‰‹åŠ¨æ£€æŸ¥åŸºç¡€ä»·æ˜¯å¦æ­£ç¡®</p>
            <p style="margin-bottom: 0;">â€¢ å¦‚é‡åˆ°é—®é¢˜ï¼Œè¯·æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°çš„è¯¦ç»†æ—¥å¿—</p>
          </div>
        </div>

        <div>
          <h3 style="font-size: 18px; font-weight: 600; margin-bottom: 12px; color: var(--color-primary);">ğŸ”Œ æµè§ˆå™¨æ’ä»¶ç‰ˆæœ¬</h3>
          <div style="background: var(--color-bg); padding: 16px; border-radius: var(--radius-md); line-height: 1.8;">
            <p style="margin-bottom: 12px;">å¦‚æœä½ åªæœ‰ New API åå°ç™»å½•æƒé™ï¼ˆæ— æ•°æ®åº“è®¿é—®æƒé™ï¼‰ï¼Œæ¨èä½¿ç”¨æµè§ˆå™¨æ’ä»¶ç‰ˆæœ¬ï¼š</p>
            <p style="margin-bottom: 12px;"><strong>âœ¨ ä¸€é”®è‡ªåŠ¨åŒæ­¥ï¼š</strong>æ— éœ€æ‰‹åŠ¨æ‰§è¡Œ SQLï¼Œç‚¹å‡»æŒ‰é’®å³å¯å®Œæˆ</p>
            <p style="margin-bottom: 12px;"><strong>ğŸ”’ æ›´å®‰å…¨ï¼š</strong>ä½¿ç”¨æµè§ˆå™¨ Cookie è®¤è¯ï¼Œæ— éœ€ API Token</p>
            <p style="margin-bottom: 0;"><strong>ğŸ“¦ å®‰è£…æ–¹å¼ï¼š</strong>æŸ¥çœ‹é¡¹ç›®ä¸­çš„ <code>PriceSyncPro-Extension</code> æ–‡ä»¶å¤¹</p>
          </div>
        </div>
      </div>
    </div>

    <!-- About Tab -->
    <div class="tab-content" id="about-tab">
      <div class="input-card">
        <div style="text-align: center; margin-bottom: 32px;">
          <div style="width: 80px; height: 80px; background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-secondary) 100%); border-radius: 20px; display: inline-flex; align-items: center; justify-content: center; font-size: 40px; box-shadow: 0 8px 24px rgba(0, 122, 255, 0.3); margin-bottom: 16px;">ğŸš€</div>
          <h1 style="font-size: 32px; font-weight: 600; margin-bottom: 8px; letter-spacing: -0.5px;">PriceSyncPro</h1>
          <p style="font-size: 16px; color: var(--color-text-secondary); margin-bottom: 8px;">New API æ™ºèƒ½ä»·æ ¼åŒæ­¥å·¥å…·</p>
          <p style="font-size: 14px; color: var(--color-text-secondary);">ç‰ˆæœ¬ 1.0.0</p>
        </div>

        <div style="margin-bottom: 24px;">
          <h3 style="font-size: 18px; font-weight: 600; margin-bottom: 12px; color: var(--color-primary);">ğŸ“ é¡¹ç›®ç®€ä»‹</h3>
          <div style="background: var(--color-bg); padding: 16px; border-radius: var(--radius-md); line-height: 1.8;">
            <p style="margin-bottom: 12px;">PriceSyncPro æ˜¯ä¸€ä¸ªä¸“ä¸º New API è®¾è®¡çš„æ™ºèƒ½ä»·æ ¼åŒæ­¥å·¥å…·ï¼Œè§£å†³è‡ªå®šä¹‰æ¨¡å‹å‰ç¼€å¯¼è‡´çš„ä»·æ ¼åŒæ­¥å¤±æ•ˆé—®é¢˜ã€‚</p>
            <p style="margin-bottom: 0;">é€šè¿‡"ä¼—æ•°æŠ•ç¥¨"ç®—æ³•æ™ºèƒ½æ¨æ–­ä¸Šæ¸¸ç³»ç»Ÿçš„éšè—åŸºç¡€ä»·ï¼Œç²¾ç¡®è®¡ç®—æ¯ä¸ªæ¨¡å‹çš„çœŸå®ä»·æ ¼ï¼Œæ”¯æŒä¸€é”®ç”Ÿæˆæ•°æ®åº“æ›´æ–° SQLã€‚</p>
          </div>
        </div>

        <div style="margin-bottom: 24px;">
          <h3 style="font-size: 18px; font-weight: 600; margin-bottom: 12px; color: var(--color-primary);">âœ¨ æ ¸å¿ƒç‰¹æ€§</h3>
          <div style="background: var(--color-bg); padding: 16px; border-radius: var(--radius-md); line-height: 1.8;">
            <p style="margin-bottom: 12px;">ğŸ§  <strong>æ™ºèƒ½ä»·æ ¼æ¨æ–­ï¼š</strong>è‡ªåŠ¨æ¨æ–­ä¸Šæ¸¸ç³»ç»Ÿçš„éšè—åŸºç¡€ä»·</p>
            <p style="margin-bottom: 12px;">ğŸ¯ <strong>ç²¾ç¡®è®¡ç®—ï¼š</strong>æ”¯æŒæŒ‰æ¬¡è®¡è´¹å’ŒæŒ‰é‡è®¡è´¹ä¸¤ç§æ¨¡å¼</p>
            <p style="margin-bottom: 12px;">ğŸ”§ <strong>æ™ºèƒ½åˆå¹¶ï¼š</strong>åªæ›´æ–°å½“å‰å‰ç¼€ï¼Œä¿ç•™å…¶ä»–é…ç½®</p>
            <p style="margin-bottom: 12px;">ğŸ“Š <strong>æ•°æ®å¯¼å‡ºï¼š</strong>æ”¯æŒ CSV æ ¼å¼å¯¼å‡º</p>
            <p style="margin-bottom: 12px;">ğŸ”Œ <strong>æµè§ˆå™¨æ’ä»¶ï¼š</strong>ä¸€é”®è‡ªåŠ¨åŒæ­¥ï¼Œæ— éœ€æ‰‹åŠ¨æ‰§è¡Œ SQL</p>
            <p style="margin-bottom: 0;">ğŸ“š <strong>å®˜æ–¹ä»·æ ¼åº“ï¼š</strong>å†…ç½® 120+ ä¸»æµæ¨¡å‹å®˜æ–¹ä»·æ ¼</p>
          </div>
        </div>

        <div style="margin-bottom: 24px;">
          <h3 style="font-size: 18px; font-weight: 600; margin-bottom: 12px; color: var(--color-primary);">ğŸ”— ç›¸å…³é“¾æ¥</h3>
          <div style="display: grid; gap: 12px;">
            <a href="https://github.com/sycg767/PriceSyncPro" target="_blank" style="display: flex; align-items: center; gap: 12px; padding: 16px; background: var(--color-bg); border-radius: var(--radius-md); text-decoration: none; color: var(--color-text-primary); transition: all 0.2s ease;">
              <svg style="width: 24px; height: 24px; flex-shrink: 0;" viewBox="0 0 16 16" fill="currentColor">
                <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/>
              </svg>
              <div style="flex: 1;">
                <div style="font-weight: 600; margin-bottom: 4px;">GitHub ä»“åº“</div>
                <div style="font-size: 13px; color: var(--color-text-secondary);">æŸ¥çœ‹æºä»£ç ã€æäº¤é—®é¢˜ã€å‚ä¸è´¡çŒ®</div>
              </div>
              <span style="color: var(--color-primary);">â†’</span>
            </a>
            
            <a href="https://github.com/sycg767/PriceSyncPro/issues" target="_blank" style="display: flex; align-items: center; gap: 12px; padding: 16px; background: var(--color-bg); border-radius: var(--radius-md); text-decoration: none; color: var(--color-text-primary); transition: all 0.2s ease;">
              <span style="font-size: 24px; flex-shrink: 0;">ğŸ›</span>
              <div style="flex: 1;">
                <div style="font-weight: 600; margin-bottom: 4px;">é—®é¢˜åé¦ˆ</div>
                <div style="font-size: 13px; color: var(--color-text-secondary);">æŠ¥å‘Š Bugã€æå‡ºåŠŸèƒ½å»ºè®®</div>
              </div>
              <span style="color: var(--color-primary);">â†’</span>
            </a>
            
            <a href="https://github.com/sycg767/PriceSyncPro/blob/main/README.md" target="_blank" style="display: flex; align-items: center; gap: 12px; padding: 16px; background: var(--color-bg); border-radius: var(--radius-md); text-decoration: none; color: var(--color-text-primary); transition: all 0.2s ease;">
              <span style="font-size: 24px; flex-shrink: 0;">ğŸ“–</span>
              <div style="flex: 1;">
                <div style="font-weight: 600; margin-bottom: 4px;">å®Œæ•´æ–‡æ¡£</div>
                <div style="font-size: 13px; color: var(--color-text-secondary);">è¯¦ç»†çš„ä½¿ç”¨æ•™ç¨‹å’Œ API æ–‡æ¡£</div>
              </div>
              <span style="color: var(--color-primary);">â†’</span>
            </a>
          </div>
        </div>

        <div style="margin-bottom: 24px;">
          <h3 style="font-size: 18px; font-weight: 600; margin-bottom: 12px; color: var(--color-primary);">ğŸ‘¨â€ğŸ’» ä½œè€…ä¿¡æ¯</h3>
          <div style="background: var(--color-bg); padding: 16px; border-radius: var(--radius-md); line-height: 1.8;">
            <p style="margin-bottom: 12px;"><strong>å¼€å‘è€…ï¼š</strong>sycg767</p>
            <p style="margin-bottom: 12px;"><strong>GitHubï¼š</strong><a href="https://github.com/sycg767" target="_blank" style="color: var(--color-primary); text-decoration: none;">@sycg767</a></p>
            <p style="margin-bottom: 0;"><strong>å¼€æºåè®®ï¼š</strong>MIT License</p>
          </div>
        </div>

        <div>
          <h3 style="font-size: 18px; font-weight: 600; margin-bottom: 12px; color: var(--color-primary);">ğŸ™ è‡´è°¢</h3>
          <div style="background: var(--color-bg); padding: 16px; border-radius: var(--radius-md); line-height: 1.8;">
            <p style="margin-bottom: 12px;">æ„Ÿè°¢æ‰€æœ‰ä½¿ç”¨å’Œåé¦ˆçš„ç”¨æˆ·ï¼</p>
            <p style="margin-bottom: 0;">å¦‚æœè¿™ä¸ªå·¥å…·å¯¹ä½ æœ‰å¸®åŠ©ï¼Œæ¬¢è¿åœ¨ GitHub ä¸Šç»™ä¸ª â­ Starï¼</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <div class="footer">
      <span class="footer-badge">PriceSyncPro v1.0.0</span> | æ™ºèƒ½ä»·æ ¼åŒæ­¥å·¥å…· |
      <a href="https://github.com/sycg767/PriceSyncPro" target="_blank" style="color: var(--color-primary); text-decoration: none; font-weight: 600;">GitHub</a>
    </div>
  </div>

  <script src="pricing-engine.js"></script>
  <script>
    const engine = new PricingEngine();
    let currentResults = null;
    let generatedSQL = '';

    // DOM å…ƒç´ 
    const analyzeBtn = document.getElementById('analyzeBtn');
    const sampleBtn = document.getElementById('sampleBtn');
    const exportBtn = document.getElementById('exportBtn');
    const copyBtn = document.getElementById('copyBtn');
    const generateSqlBtn = document.getElementById('generateSqlBtn');
    const copySqlBtn = document.getElementById('copySqlBtn');
    const upstreamUrlInput = document.getElementById('upstreamUrl');
    const messageArea = document.getElementById('messageArea');
    const sqlMessageArea = document.getElementById('sqlMessageArea');
    const statsCard = document.getElementById('statsCard');
    const resultsCard = document.getElementById('resultsCard');
    const sqlOutput = document.getElementById('sqlOutput');

    // åˆå§‹åŒ–
    (async function init() {
      try {
        await engine.loadOfficialPrices();
        showMessage('success', 'å®˜æ–¹ä»·æ ¼æ•°æ®åº“åŠ è½½æˆåŠŸ');
        // 3ç§’åè‡ªåŠ¨éšè—æˆåŠŸæ¶ˆæ¯
        setTimeout(() => {
          messageArea.innerHTML = '';
        }, 3000);
      } catch (error) {
        showMessage('error', `åˆå§‹åŒ–å¤±è´¥: ${error.message}`);
        analyzeBtn.disabled = true;
      }
    })();

    // åˆ‡æ¢æ ‡ç­¾é¡µ
    function switchTab(tabName) {
      document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
      document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
      
      event.target.classList.add('active');
      document.getElementById(tabName + '-tab').classList.add('active');
    }

    // ä¸»åˆ†ææµç¨‹
    analyzeBtn.addEventListener('click', async () => {
      const url = upstreamUrlInput.value.trim();
      
      if (!url) {
        showMessage('error', 'âš ï¸ è¯·è¾“å…¥ä¸Šæ¸¸å®šä»·æ¥å£åœ°å€');
        return;
      }

      setLoading(true);
      hideResults();

      try {
        showMessage('info', 'ğŸ“¡ æ­£åœ¨è·å–ä¸Šæ¸¸å®šä»·æ•°æ®...');
        await engine.fetchUpstreamData(url);
        
        showMessage('info', 'ğŸ§  æ­£åœ¨æ™ºèƒ½æ¨æ–­éšè—åŸºç¡€ä»·...');
        const inference = engine.inferBasePrice();
        
        showMessage('info', 'ğŸ’° æ­£åœ¨è®¡ç®—æ‰€æœ‰æ¨¡å‹ä»·æ ¼...');
        currentResults = engine.calculatePricing();
        
        displayStats(inference);
        displayResults(currentResults);
        
        showMessage('success', `âœ… åˆ†æå®Œæˆï¼å…±è®¡ç®— ${currentResults.length} ä¸ªæ¨¡å‹çš„ä»·æ ¼`);
        
        exportBtn.disabled = false;
        copyBtn.disabled = false;
        generateSqlBtn.disabled = false;
        
      } catch (error) {
        showMessage('error', `âŒ åˆ†æå¤±è´¥: ${error.message}`);
        console.error('åˆ†æé”™è¯¯:', error);
      } finally {
        setLoading(false);
      }
    });

    // åŠ è½½ç¤ºä¾‹æ•°æ®
    sampleBtn.addEventListener('click', async () => {
      setLoading(true);
      hideResults();

      try {
        showMessage('info', 'ğŸ§ª æ­£åœ¨åŠ è½½ç¤ºä¾‹æ•°æ®...');
        engine.loadSampleData();
        
        showMessage('info', 'ğŸ§  æ­£åœ¨æ™ºèƒ½æ¨æ–­éšè—åŸºç¡€ä»·...');
        const inference = engine.inferBasePrice();
        
        showMessage('info', 'ğŸ’° æ­£åœ¨è®¡ç®—æ‰€æœ‰æ¨¡å‹ä»·æ ¼...');
        currentResults = engine.calculatePricing();
        
        displayStats(inference);
        displayResults(currentResults);
        
        showMessage('success', `âœ… ç¤ºä¾‹æ•°æ®åˆ†æå®Œæˆï¼`);
        
        exportBtn.disabled = false;
        copyBtn.disabled = false;
        generateSqlBtn.disabled = false;
        
      } catch (error) {
        showMessage('error', `âŒ åŠ è½½ç¤ºä¾‹æ•°æ®å¤±è´¥: ${error.message}`);
        console.error('ç¤ºä¾‹æ•°æ®é”™è¯¯:', error);
      } finally {
        setLoading(false);
      }
    });

    // å¯¼å‡º CSV
    exportBtn.addEventListener('click', () => {
      try {
        const csv = engine.exportToCSV();
        const blob = new Blob(['\ufeff' + csv], { type: 'text/csv;charset=utf-8;' });
        const link = document.createElement('a');
        const url = URL.createObjectURL(blob);
        
        link.setAttribute('href', url);
        link.setAttribute('download', `newapi_pricing_${Date.now()}.csv`);
        link.style.visibility = 'hidden';
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        
        showMessage('success', 'âœ… CSV æ–‡ä»¶å·²å¯¼å‡º');
      } catch (error) {
        showMessage('error', `âŒ å¯¼å‡ºå¤±è´¥: ${error.message}`);
      }
    });

    // å¤åˆ¶è¡¨æ ¼æ•°æ®
    copyBtn.addEventListener('click', async () => {
      try {
        const csv = engine.exportToCSV();
        await navigator.clipboard.writeText(csv);
        showMessage('success', 'âœ… è¡¨æ ¼æ•°æ®å·²å¤åˆ¶åˆ°å‰ªè´´æ¿');
      } catch (error) {
        showMessage('error', `âŒ å¤åˆ¶å¤±è´¥: ${error.message}`);
      }
    });

    // ç”Ÿæˆ SQL
    generateSqlBtn.addEventListener('click', () => {
      if (!currentResults || currentResults.length === 0) {
        showSqlMessage('error', 'âš ï¸ è¯·å…ˆå®Œæˆä»·æ ¼åˆ†æ');
        return;
      }

      const mode = document.getElementById('sqlMode').value;
      const prefix = document.getElementById('modelPrefix').value.trim();
      
      // åˆ†ç±»æ”¶é›†æ•°æ®
      const modelPrices = {};
      const modelRatios = {};
      const completionRatios = {};
      
      let perUseCount = 0;
      let usageBasedCount = 0;
      
      currentResults.forEach(m => {
        const finalModelName = prefix ? prefix + m.smartName : m.smartName;
        
        if (m.quotaType === 1) {
          modelPrices[finalModelName] = parseFloat(m.inputPrice.toFixed(4));
          perUseCount++;
        } else {
          if (m.modelRatio !== undefined && m.modelRatio !== null) {
            modelRatios[finalModelName] = m.modelRatio;
          }
          if (m.completionRatio !== undefined && m.completionRatio !== null) {
            completionRatios[finalModelName] = m.completionRatio;
          }
          usageBasedCount++;
        }
      });

      let sql = '-- ==========================================\n';
      sql += '-- New API æ™ºèƒ½åˆå¹¶å®šä»·é…ç½® SQL\n';
      sql += '-- ==========================================\n';
      sql += '-- ç”Ÿæˆæ—¶é—´: ' + new Date().toLocaleString('zh-CN') + '\n';
      sql += '-- SQL æ¨¡å¼: ' + (mode === 'merge' ? 'åˆå¹¶æ¨¡å¼' : 'å¸¦å¤‡ä»½æ¨¡å¼') + '\n';
      sql += '-- æ¨¡å‹å‰ç¼€: ' + (prefix || 'æ— å‰ç¼€') + '\n';
      sql += '-- âš ï¸ é‡è¦è¯´æ˜ï¼šæ­¤ SQL ä½¿ç”¨æ™ºèƒ½åˆå¹¶ç­–ç•¥\n';
      sql += '-- åªä¼šæ›´æ–°/æ·»åŠ å½“å‰å‰ç¼€çš„æ¨¡å‹ï¼Œä¸ä¼šåˆ é™¤å…¶ä»–å‰ç¼€/æ¸ é“çš„é…ç½®\n';
      sql += '-- ==========================================\n\n';

      if (mode === 'backup') {
        sql += '-- ç¬¬ä¸€æ­¥ï¼šå¤‡ä»½ç°æœ‰é…ç½®ï¼ˆå¯é€‰ï¼‰\n';
        sql += 'CREATE TABLE IF NOT EXISTS options_backup_' + Date.now() + ' AS SELECT * FROM options WHERE key IN (\'ModelPrice\', \'ModelRatio\', \'CompletionRatio\');\n\n';
      }

      sql += '-- ==========================================\n';
      sql += '-- æ™ºèƒ½åˆå¹¶ SQL è¯­å¥ï¼ˆå¯ç›´æ¥æ‰§è¡Œï¼‰\n';
      sql += '-- ==========================================\n';
      sql += '-- ä½¿ç”¨ JSON_SET() å‡½æ•°é€ä¸ªæ›´æ–°æ¨¡å‹é…ç½®\n';
      sql += '-- ä¿ç•™ç°æœ‰é…ç½®ï¼Œåªæ›´æ–°/æ·»åŠ å½“å‰å‰ç¼€çš„æ¨¡å‹\n';
      sql += '-- ==========================================\n\n';

      // ModelPrice
      if (perUseCount > 0) {
        sql += '-- ModelPrice (æŒ‰æ¬¡è®¡è´¹æ¨¡å‹ï¼Œå…± ' + perUseCount + ' ä¸ª)\n';
        Object.entries(modelPrices).forEach(([modelName, price]) => {
          // è½¬ä¹‰åŒå¼•å·å’Œåæ–œæ ï¼ˆJSON è·¯å¾„è¦æ±‚ï¼‰
          const escapedName = modelName.replace(/\\/g, '\\\\').replace(/"/g, '\\"');
          sql += `UPDATE options SET value = JSON_SET(COALESCE(value, '{}'), '$."${escapedName}"', ${price}) WHERE \`key\` = 'ModelPrice';\n`;
        });
        sql += '\n';
      }

      // ModelRatio
      if (usageBasedCount > 0 && Object.keys(modelRatios).length > 0) {
        sql += '-- ModelRatio (æŒ‰é‡è®¡è´¹æ¨¡å‹ï¼Œå…± ' + Object.keys(modelRatios).length + ' ä¸ª)\n';
        Object.entries(modelRatios).forEach(([modelName, ratio]) => {
          const escapedName = modelName.replace(/\\/g, '\\\\').replace(/"/g, '\\"');
          sql += `UPDATE options SET value = JSON_SET(COALESCE(value, '{}'), '$."${escapedName}"', ${ratio}) WHERE \`key\` = 'ModelRatio';\n`;
        });
        sql += '\n';
      }

      // CompletionRatio
      if (Object.keys(completionRatios).length > 0) {
        sql += '-- CompletionRatio (è¾“å‡ºå€ç‡ï¼Œå…± ' + Object.keys(completionRatios).length + ' ä¸ª)\n';
        Object.entries(completionRatios).forEach(([modelName, ratio]) => {
          const escapedName = modelName.replace(/\\/g, '\\\\').replace(/"/g, '\\"');
          sql += `UPDATE options SET value = JSON_SET(COALESCE(value, '{}'), '$."${escapedName}"', ${ratio}) WHERE \`key\` = 'CompletionRatio';\n`;
        });
        sql += '\n';
      }

      sql += '-- ==========================================\n';
      sql += '-- æ›´æ–°ç»Ÿè®¡\n';
      sql += '-- ==========================================\n';
      sql += '-- æŒ‰æ¬¡è®¡è´¹æ¨¡å‹: ' + perUseCount + ' ä¸ª\n';
      sql += '-- æŒ‰é‡è®¡è´¹æ¨¡å‹: ' + usageBasedCount + ' ä¸ª\n';
      sql += '-- æ€»è®¡: ' + currentResults.length + ' ä¸ªæ¨¡å‹\n';

      generatedSQL = sql;
      sqlOutput.textContent = sql;
      sqlOutput.classList.add('show');
      copySqlBtn.disabled = false;
      
      showSqlMessage('success', 'âœ… SQL å·²ç”ŸæˆæˆåŠŸï¼å…± ' + currentResults.length + ' ä¸ªæ¨¡å‹');
    });

    // å¤åˆ¶ SQL
    copySqlBtn.addEventListener('click', async () => {
      try {
        await navigator.clipboard.writeText(generatedSQL);
        showSqlMessage('success', 'âœ… SQL å·²å¤åˆ¶åˆ°å‰ªè´´æ¿');
      } catch (error) {
        showSqlMessage('error', 'âŒ å¤åˆ¶å¤±è´¥: ' + error.message);
      }
    });

    // å·¥å…·å‡½æ•°
    function setLoading(isLoading) {
      analyzeBtn.disabled = isLoading;
      sampleBtn.disabled = isLoading;
      
      if (isLoading) {
        analyzeBtn.innerHTML = '<span class="spinner"></span><span>åˆ†æä¸­...</span>';
      } else {
        analyzeBtn.innerHTML = '<span>ğŸ”</span><span>å¼€å§‹æ™ºèƒ½åˆ†æ</span>';
      }
    }

    function hideResults() {
      statsCard.classList.remove('show');
      resultsCard.classList.remove('show');
      exportBtn.disabled = true;
      copyBtn.disabled = true;
      generateSqlBtn.disabled = true;
      sqlOutput.classList.remove('show');
      copySqlBtn.disabled = true;
    }

    function showMessage(type, text) {
      messageArea.innerHTML = `
        <div class="message-card message-${type} show">
          <span class="message-icon">${type === 'success' ? 'âœ…' : type === 'error' ? 'âŒ' : 'â„¹ï¸'}</span>
          <span>${text}</span>
        </div>
      `;
    }

    function showSqlMessage(type, text) {
      sqlMessageArea.innerHTML = `
        <div class="message-card message-${type} show">
          <span class="message-icon">${type === 'success' ? 'âœ…' : type === 'error' ? 'âŒ' : 'â„¹ï¸'}</span>
          <span>${text}</span>
        </div>
      `;
    }

    function displayStats(inference) {
      document.getElementById('basePriceStat').textContent = '$' + inference.basePrice.toFixed(2);
      document.getElementById('confidenceStat').textContent = inference.confidence + '%';
      document.getElementById('matchedStat').textContent = inference.matchedModels;
      document.getElementById('totalStat').textContent = inference.totalModels;
      
      statsCard.classList.add('show');
    }

    function displayResults(results) {
      const tbody = document.getElementById('resultsBody');
      tbody.innerHTML = '';
      
      results.forEach(model => {
        const row = tbody.insertRow();
        row.innerHTML = `
          <td class="model-name">${model.modelName}</td>
          <td>${model.smartName}</td>
          <td><span class="mode-badge mode-${model.quotaType === 1 ? 'peruse' : 'usage'}">${model.quotaType === 1 ? 'æŒ‰æ¬¡' : 'æŒ‰é‡'}</span></td>
          <td class="price-cell">${model.inputPrice.toFixed(4)}</td>
          <td class="price-cell">${model.outputPrice.toFixed(4)}</td>
          <td>${model.modelRatio !== null ? model.modelRatio.toFixed(2) : '-'}</td>
          <td>${model.completionRatio !== null ? model.completionRatio.toFixed(2) : '-'}</td>
        `;
      });
      
      resultsCard.classList.add('show');
    }
  </script>
</body>
</html>